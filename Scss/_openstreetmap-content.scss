// _openstreetmap-content.scss
// Content Element Styles for OpenStreetMap Content
// Interaktive OpenStreetMap-Karte mit linksbündigem Adress-Overlay

@use '@build/Library/Scss/helpers/breakpoints' as breakpoints;

// Hinweis: Leaflet CSS wird via VHS ViewHelper im Template geladen:
// <v:asset.style path="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" external="1"/>

// ============================================
// Leaflet CSS Overrides (Leaflet verwendet !important)
// ============================================
.content-openstreet-map {
	.leaflet-container {
		font-family: inherit;
	}

	.leaflet-control-zoom {
		border: none;
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
	}

	.leaflet-control-zoom a {
		background-color: #fff;
		color: #333;
		border: 1px solid #ccc;
		line-height: 34px;
		width: 36px;
		height: 36px;

		&:hover {
			background-color: #f4f4f4;
		}
	}

	.leaflet-control-attribution {
		background-color: rgba(255, 255, 255, 0.8);
		font-size: 11px;
	}

	// Custom SVG Marker
	&__marker {
		filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));

		// Button-Styles deaktivieren (für role=button Reset)
		--default-background-color: transparent !important;
		--default-border-color: transparent !important;
		--default-box-shadow: none !important;
		--default-color: inherit !important;
		background: transparent !important;
		border: none !important;
		box-shadow: none !important;

		&-inner {
			display: block;
			line-height: 0;

			svg {
				display: block;
				width: 40px;
				height: 80px;
			}
		}
	}
}

// ============================================
// Main Container
// ============================================
.content-openstreet-map {
	position: relative;
	display: flex;
	align-items: center;
	justify-content: center;
	background: var(--template-bg-light, #f5f5f5);
	border-radius: var(--border-radius-md, 8px);
	overflow: hidden;

	// Aspect Ratio Support (wird via inline-style gesetzt)
	// In Template: aspect-ratio: 16/9;

	// Grayscale Support (wird via JavaScript auf mapPane angewendet)
	// In Controller: mapPane.style.filter = 'grayscale(100%)'

	&__map {
		position: absolute;
		inset: 0;
		width: 100%;
		height: 100%;
		z-index: 1;
	}

	// ============================================
	// Left Overlay mit Address und Contact
	// ============================================
	&__overlay {
		position: absolute;
		top: 50%;
		left: var(--space-m, 1.5rem);
		transform: translateY(-50%);
		z-index: 10;
		width: 50%;
		max-width: 320px;
		pointer-events: none; // Click-through zur Karte
	}

	&__address-card {
		background: rgba(255, 255, 255, 0.95);
		backdrop-filter: blur(10px);
		padding: var(--space-2xs, 1.5rem);
		border-radius: var(--border-radius-md, 8px);
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
		text-align: center;
		pointer-events: auto; // Clickable Card
	}

	&__title {
		margin: 0 0 var(--space-s, 1rem) 0;
		font-size: var(--text-base, 1rem);
		font-weight: 700;
		color: var(--template-text-primary, #212529);
	}

	&__address {
		margin: 0 0 var(--space-s, 1rem) 0;
		font-style: normal;
		font-size: var(--text-xs, 0.75rem);
		line-height: 1.4;
		color: var(--template-text-secondary, #6c757d);
	}

	// Route Link Button
	&__route-link {
		width: 100%;
		text-align: center;
		padding: var(--space-xs, 0.5rem) var(--space-s, 1rem);
		font-size: var(--text-xs, 0.75rem);
	}

	// ============================================
	// Loading State
	// ============================================
	&__loading {
		position: absolute;
		inset: 0;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		gap: var(--space-s, 1rem);
		z-index: 5;
		background: var(--template-bg-light, #f5f5f5);
	}

	&__loading-spinner {
		font-size: 2rem;
		animation: spin 1s linear infinite;
	}

	&__loading-text {
		margin: 0;
		font-size: var(--text-sm, 0.875rem);
		color: var(--template-text-muted, #6c757d);
	}

	// ============================================
	// Error State
	// ============================================
	&__error {
		position: absolute;
		inset: 0;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		gap: var(--space-s, 1rem);
		z-index: 5;
		padding: var(--space-m, 1.5rem);
		background: var(--template-bg-light, #f5f5f5);
		text-align: center;
	}

	&__error-icon {
		font-size: 2.5rem;
	}

	&__error-text {
		margin: 0;
		font-size: var(--text-base, 1rem);
		color: var(--template-text-secondary, #6c757d);
	}
}

// ============================================
// Screen Reader Only
// ============================================
.visually-hidden {
	position: absolute;
	width: 1px;
	height: 1px;
	padding: 0;
	margin: -1px;
	overflow: hidden;
	clip: rect(0, 0, 0, 0);
	white-space: nowrap;
	border: 0;
}

// ============================================
// Animations
// ============================================
@keyframes spin {
	from {
		transform: rotate(0deg);
	}
	to {
		transform: rotate(360deg);
	}
}

// ============================================
// Responsive Design
// ============================================
@include breakpoints.bp-down(md) {
	.content-openstreet-map {
		min-height: 250px;

		&__overlay {
			width: 50%;
			max-width: none;
			left: var(--space-s, 1rem);
			right: var(--space-s, 1rem);
		}

		&__address-card {
			padding: var(--space-s, 1rem);
		}
	}
}

// ============================================
// Reduced Motion Support
// ============================================
@media (prefers-reduced-motion: reduce) {
	.content-openstreet-map__loading-spinner {
		animation: none;
	}

	.content-openstreet-map__link {
		transition: none;
	}
}

// ============================================
// Backend Preview Styles (TYPO3 Backend)
// ============================================
.typo3-backend {
	.content-openstreet-map-preview {
		padding: 0.5rem;
		background: #f5f5f5;
		border-radius: 4px;
		font-size: 0.875rem;

		strong {
			display: block;
			margin-bottom: 0.25rem;
		}
	}
}
